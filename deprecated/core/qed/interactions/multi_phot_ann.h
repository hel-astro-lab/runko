#pragma once

#include "core/qed/interactions/interaction.h"


namespace qed {
  using std::string;
  using std::tuple;


 // Multi-photon Breit-Wheeler process 
 // also known as magnetic single-photon pair creation
 //
 // Refs Duclous et al. 2011 implementation
 //
class MultiPhotAnn :
  public Interaction
{

private:

  float CHIX[32] = {1.0000000e-02, 1.4412196e-02, 2.0771139e-02, 2.9935773e-02, 4.3144023e-02, 6.2180011e-02, 8.9615050e-02, 1.2915497e-01, 1.8614067e-01, 2.6826958e-01, 3.8663538e-01, 5.5722648e-01, 8.0308572e-01, 1.1574229e+00, 1.6681005e+00, 2.4040992e+00, 3.4648349e+00, 4.9935879e+00, 7.1968567e+00, 1.0372251e+01, 1.4948691e+01, 2.1544347e+01, 3.1050135e+01, 4.4750063e+01, 6.4494668e+01, 9.2950979e+01, 1.3396277e+02, 1.9306977e+02, 2.7825594e+02, 4.0102791e+02, 5.7796929e+02, 8.3298066e+02 };

  float XI[32][33] = {
    { 2.0297324e-09,5.8882040e-09,1.6640380e-08,4.5804733e-08,1.2278642e-07,3.2048294e-07,8.1431343e-07,2.0138334e-06,4.8462933e-06,1.1346315e-05,2.5838057e-05,5.7216569e-05,1.2317835e-04,2.5774378e-04,5.2404842e-04,1.0350716e-03,1.9855028e-03,3.6979186e-03,6.6852565e-03,1.1728517e-02,1.9963115e-02,3.2959279e-02,5.2772388e-02,8.1930659e-02,1.2332422e-01,1.7996614e-01,2.5461629e-01,3.4929325e-01,4.6474242e-01,5.9996836e-01,7.5195956e-01,9.1571989e-01,1.0000000e+00},
    { 2.0220629e-09,5.8290661e-09,1.6373458e-08,4.4809545e-08,1.1946358e-07,3.1022441e-07,7.8456138e-07,1.9320471e-06,4.6320361e-06,1.0809546e-05,2.4549149e-05,5.4245710e-05,1.1659915e-04,2.4373738e-04,4.9537791e-04,9.7864538e-04,1.8787589e-03,3.5039156e-03,6.3467491e-03,1.1162004e-02,1.9054866e-02,3.1566511e-02,5.0733595e-02,7.9088961e-02,1.1956567e-01,1.7527072e-01,2.4911319e-01,3.4330542e-01,4.5880118e-01,5.9478024e-01,7.4831663e-01,9.1436123e-01,1.0000000e+00},
    { 2.0142473e-09,5.7854931e-09,1.6188698e-08,4.4127926e-08,1.1717222e-07,3.0305264e-07,7.6341280e-07,1.8728686e-06,4.4741747e-06,1.0406869e-05,2.3564861e-05,5.1936883e-05,1.1139710e-04,2.3247271e-04,4.7192806e-04,9.3171620e-04,1.7884916e-03,3.3371113e-03,6.0508256e-03,1.0658452e-02,1.8233996e-02,3.0286563e-02,4.8828455e-02,7.6389068e-02,1.1593532e-01,1.7066111e-01,2.4362395e-01,3.3723970e-01,4.5269285e-01,5.8937096e-01,7.4446855e-01,9.1290884e-01,1.0000000e+00},
    { 2.0192306e-09,5.8014686e-09,1.6224347e-08,4.4168371e-08,1.1705774e-07,3.0203341e-07,7.5873308e-07,1.8556951e-06,4.4187881e-06,1.0243889e-05,2.3118959e-05,5.0790245e-05,1.0860701e-04,2.2602041e-04,4.5770547e-04,9.0177732e-04,1.7282362e-03,3.2210932e-03,5.8370863e-03,1.0281795e-02,1.7599544e-02,2.9266249e-02,4.7264549e-02,7.4109801e-02,1.1278719e-01,1.6655941e-01,2.3861712e-01,3.3157419e-01,4.4685690e-01,5.8409091e-01,7.4063633e-01,9.1143556e-01,1.0000000e+00},
    { 2.0090736e-09,5.8123304e-09,1.6339200e-08,4.4642537e-08,1.1857864e-07,3.0626373e-07,7.6930407e-07,1.8796855e-06,4.4680448e-06,1.0333426e-05,2.3254304e-05,5.0923744e-05,1.0851973e-04,2.2504491e-04,4.5413962e-04,8.9175072e-04,1.7036953e-03,3.1665139e-03,5.7245936e-03,1.0064700e-02,1.7205045e-02,2.8589284e-02,4.6166410e-02,7.2426688e-02,1.1035447e-01,1.6325578e-01,2.3442767e-01,3.2666303e-01,4.4162898e-01,5.7921430e-01,7.3699556e-01,9.0999926e-01,1.0000000e+00},
    { 2.0007347e-09,5.8770106e-09,1.6726457e-08,4.6147419e-08,1.2347812e-07,3.2056969e-07,8.0783525e-07,1.9767698e-06,4.6986606e-06,1.0852126e-05,2.4361410e-05,5.3167517e-05,1.1283433e-04,2.3289821e-04,4.6761037e-04,9.1335944e-04,1.7356746e-03,3.2090439e-03,5.7724131e-03,1.0101567e-02,1.7195954e-02,2.8471350e-02,4.5841012e-02,7.1757610e-02,1.0917869e-01,1.6141388e-01,2.3181812e-01,3.2331689e-01,4.3779018e-01,5.7539729e-01,7.3398373e-01,9.0875227e-01,1.0000000e+00},
    { 2.0117842e-09,6.0597585e-09,1.7609827e-08,4.9412968e-08,1.3398504e-07,3.5134015e-07,8.9158979e-07,2.1910936e-06,5.2178419e-06,1.2047953e-05,2.6987864e-05,5.8678541e-05,1.2389387e-04,2.5413555e-04,5.0663126e-04,9.8191834e-04,1.8507200e-03,3.3930608e-03,6.0521482e-03,1.0503954e-02,1.7740098e-02,2.9156092e-02,4.6629208e-02,7.2560904e-02,1.0984983e-01,1.6175639e-01,2.3162325e-01,3.2243309e-01,4.3621895e-01,5.7339242e-01,7.3211365e-01,9.0787715e-01,1.0000000e+00},
    { 2.0141965e-09,6.2995676e-09,1.8894694e-08,5.4419166e-08,1.5068999e-07,4.0165244e-07,1.0316647e-06,2.5563108e-06,6.1166926e-06,1.4147021e-05,3.1655748e-05,6.8588263e-05,1.4401357e-04,2.9324886e-04,5.7949176e-04,1.1120141e-03,2.0733585e-03,3.7580501e-03,6.6247754e-03,1.1362368e-02,1.8966868e-02,3.0822057e-02,4.8769235e-02,7.5144228e-02,1.1275213e-01,1.6474566e-01,2.3437492e-01,3.2458833e-01,4.3749079e-01,5.7370577e-01,7.3174022e-01,9.0750346e-01,1.0000000e+00},
    { 2.0086275e-09,6.6124229e-09,2.0709043e-08,6.1821960e-08,1.7624402e-07,4.8066454e-07,1.2561919e-06,3.1510128e-06,7.5977259e-06,1.7635234e-05,3.9457946e-05,8.5212263e-05,1.7783230e-04,3.5904996e-04,7.0209841e-04,1.3309806e-03,2.4483658e-03,4.3740138e-03,7.5948532e-03,1.2826176e-02,2.1080591e-02,3.3737301e-02,5.2598993e-02,7.9917786e-02,1.1836618e-01,1.7092568e-01,2.4066665e-01,3.3040141e-01,4.4220988e-01,5.7686688e-01,7.3323975e-01,9.0777232e-01,1.0000000e+00},
    { 2.0060341e-09,7.0453602e-09,2.3299558e-08,7.2762411e-08,2.1515557e-07,6.0394045e-07,1.6131808e-06,4.1097433e-06,1.0007618e-05,2.3341096e-05,5.2242872e-05,1.1241937e-04,2.3297579e-04,4.6573476e-04,8.9946517e-04,1.6806043e-03,3.0419947e-03,5.3407130e-03,9.1050779e-03,1.5089245e-02,2.4331356e-02,3.8208028e-02,5.8474300e-02,8.7274339e-02,1.2710500e-01,1.8071255e-01,2.5090376e-01,3.4025737e-01,4.5073221e-01,5.8318549e-01,7.3684023e-01,9.0877470e-01,1.0000000e+00},
    { 2.0022710e-09,7.5997007e-09,2.6818064e-08,8.8344910e-08,2.7272252e-07,7.9179006e-07,2.1693032e-06,5.6264659e-06,1.3856628e-05,3.2494413e-05,7.2750769e-05,1.5589146e-04,3.2046021e-04,6.3334524e-04,1.2058924e-03,2.2161919e-03,3.9383171e-03,6.7785845e-03,1.1317783e-02,1.8356794e-02,2.8961132e-02,4.4497879e-02,6.6656386e-02,9.7442330e-02,1.3913346e-01,1.9418499e-01,2.6507335e-01,3.5406933e-01,4.6293585e-01,5.9255260e-01,7.4248077e-01,9.1049855e-01,1.0000000e+00},
    { 2.0044064e-09,8.3136946e-09,3.1574209e-08,1.1042608e-07,3.5753430e-07,1.0770174e-06,3.0324582e-06,8.0150716e-06,1.9966768e-05,4.7057106e-05,1.0528792e-04,2.2437947e-04,4.5683275e-04,8.9110377e-04,1.6696995e-03,3.0126538e-03,5.2462318e-03,8.8358520e-03,1.4421165e-02,2.2850084e-02,3.5207466e-02,5.2833225e-02,7.7324048e-02,1.1051264e-01,1.5441856e-01,2.1116512e-01,2.8285735e-01,3.7141653e-01,4.7836681e-01,6.0456931e-01,7.4989876e-01,9.1285888e-01,1.0000000e+00},
    { 2.0005395e-09,9.1555620e-09,3.7686445e-08,1.4061549e-07,4.7902694e-07,1.4998940e-06,4.3432204e-06,1.1697374e-05,2.9456241e-05,6.9693541e-05,1.5562777e-04,3.2935575e-04,6.6312183e-04,1.2747056e-03,2.3471185e-03,4.1522076e-03,7.0770223e-03,1.1651012e-02,1.8571406e-02,2.8723607e-02,4.3193211e-02,6.3266358e-02,9.0415573e-02,1.2626892e-01,1.7256103e-01,2.3106518e-01,3.0350583e-01,3.9145028e-01,4.9617627e-01,6.1850803e-01,7.5860643e-01,9.1568770e-01,1.0000000e+00},
    { 2.0070348e-09,1.0202782e-08,4.5707136e-08,1.8234368e-07,6.5402732e-07,2.1276799e-06,6.3285962e-06,1.7337644e-05,4.4042834e-05,1.0438458e-04,2.3212385e-04,4.8681510e-04,9.6742423e-04,1.8295809e-03,3.3058331e-03,5.7275793e-03,9.5467158e-03,1.5354594e-02,2.3895727e-02,3.6073882e-02,5.2948684e-02,7.5721654e-02,1.0571147e-01,1.4431914e-01,1.9298466e-01,2.5313691e-01,3.2613880e-01,4.1322860e-01,5.1545580e-01,6.3360544e-01,7.6809468e-01,9.1880823e-01,1.0000000e+00},
    { 2.0019142e-09,1.1368194e-08,5.5600715e-08,2.3745293e-07,8.9658312e-07,3.0270602e-06,9.2323343e-06,2.5673666e-05,6.5644471e-05,1.5550612e-04,3.4366075e-04,7.1294736e-04,1.3963236e-03,2.5950143e-03,4.5976088e-03,7.7980440e-03,1.2710156e-02,1.9976587e-02,3.0370315e-02,4.4787773e-02,6.4233474e-02,8.9796897e-02,1.2262328e-01,1.6388061e-01,2.1472565e-01,2.7627201e-01,3.4956345e-01,4.3555481e-01,5.3510190e-01,6.4895761e-01,7.7776364e-01,9.2200864e-01,1.0000000e+00},
    { 2.0015637e-09,1.2732769e-08,6.8024463e-08,3.1065508e-07,1.2321245e-06,4.3050221e-06,1.3421020e-05,3.7762218e-05,9.6883591e-05,2.2875023e-04,5.0115880e-04,1.0263706e-03,1.9780040e-03,3.6084799e-03,6.2648010e-03,1.0400333e-02,1.6580578e-02,2.5481614e-02,3.7880759e-02,5.4639947e-02,7.6683114e-02,1.0496953e-01,1.4046549e-01,1.8411700e-01,2.3682655e-01,2.9943718e-01,3.7272752e-01,4.5742203e-01,5.5422075e-01,6.6385202e-01,7.8714745e-01,9.2512470e-01,1.0000000e+00},
    { 2.0052881e-09,1.4305982e-08,8.3402963e-08,4.0632684e-07,1.6873925e-06,6.0792570e-06,1.9300340e-05,5.4749629e-05,1.4048879e-04,3.2967484e-04,7.1436046e-04,1.4416663e-03,2.7304480e-03,4.8860312e-03,8.3105649e-03,1.3507053e-02,2.1076018e-02,3.1704776e-02,4.6150243e-02,6.5216881e-02,8.9731809e-02,1.2051926e-01,1.5837663e-01,2.0405440e-01,2.5824256e-01,3.2156663e-01,3.9459759e-01,4.7788149e-01,5.7199718e-01,6.7765278e-01,7.9583354e-01,9.2800957e-01,1.0000000e+00},
    { 2.0036382e-09,1.6035285e-08,1.0184356e-07,5.2777370e-07,2.2866894e-06,8.4626863e-06,2.7259147e-05,7.7693265e-05,1.9879690e-04,4.6249751e-04,9.8929360e-04,1.9647435e-03,3.6540878e-03,6.4123104e-03,1.0687616e-02,1.7017416e-02,2.6017125e-02,3.8363048e-02,5.4771221e-02,7.5974280e-02,1.0269829e-01,1.3564126e-01,1.7545487e-01,2.2273097e-01,2.7799502e-01,3.4170930e-01,4.1429116e-01,4.9615382e-01,5.8778249e-01,6.8986474e-01,8.0350315e-01,9.3054865e-01,1.0000000e+00},
    { 2.0074123e-09,1.7993836e-08,1.2409823e-07,6.8123642e-07,3.0656330e-06,1.1602435e-05,3.7760590e-05,1.0773869e-04,2.7404763e-04,6.3055122e-04,1.3290449e-03,2.5944478e-03,4.7355317e-03,8.1488786e-03,1.3315124e-02,2.0787994e-02,3.1177744e-02,4.5131158e-02,6.3310254e-02,8.6371498e-02,1.1494680e-01,1.4962717e-01,1.9094968e-01,2.3938867e-01,2.9535282e-01,3.5919124e-01,4.3121434e-01,5.1173948e-01,6.0117822e-01,7.0019298e-01,8.0996880e-01,9.3267372e-01,1.0000000e+00},
    { 2.0051675e-09,2.0097651e-08,1.5002706e-07,8.6891272e-07,4.0440557e-06,1.5588165e-05,5.1069811e-05,1.4540895e-04,3.6675584e-04,8.3301126e-04,1.7279631e-03,3.3134834e-03,5.9349406e-03,1.0018583e-02,1.6061438e-02,2.4615629e-02,3.6269588e-02,5.1628534e-02,7.1296001e-02,9.5857429e-02,1.2586618e-01,1.6183198e-01,2.0421167e-01,2.5340274e-01,3.0974102e-01,3.7350588e-01,4.4493957e-01,5.2429269e-01,6.1191703e-01,7.0844297e-01,8.1510609e-01,9.3433780e-01,1.0000000e+00},
    { 2.0003777e-09,2.2361150e-08,1.7997131e-07,1.0948298e-06,5.2463836e-06,2.0510807e-05,6.7400240e-05,1.9093882e-04,4.7645686e-04,1.0665603e-03,2.1753102e-03,4.0959858e-03,7.2005192e-03,1.1930906e-02,1.8784655e-02,2.8297155e-02,4.1023654e-02,5.7522813e-02,7.8342766e-02,1.0400977e-01,1.3501893e-01,1.7182628e-01,2.1484162e-01,2.6442226e-01,3.2086894e-01,3.8442741e-01,4.5530309e-01,5.3370265e-01,6.1992811e-01,7.1457015e-01,8.1888658e-01,9.3552800e-01,1.0000000e+00},
    { 2.0010461e-09,2.4853441e-08,2.1463498e-07,1.3645421e-06,6.7000509e-06,2.6453300e-05,8.6876320e-05,2.4417512e-04,6.0153875e-04,1.3252966e-03,2.6557197e-03,4.9094710e-03,8.4733125e-03,1.3791056e-02,2.1346989e-02,3.1648967e-02,4.5213481e-02,6.2553776e-02,8.4170995e-02,1.1054758e-01,1.4214176e-01,1.7938196e-01,2.2266024e-01,2.7232473e-01,3.2867216e-01,3.9194406e-01,4.6233449e-01,5.4002482e-01,6.2527528e-01,7.1863009e-01,8.2134496e-01,9.3625381e-01,1.0000000e+00},
    { 2.0038477e-09,2.7543976e-08,2.5401729e-07,1.6794392e-06,8.4112184e-06,3.3406748e-05,1.0929909e-04,3.0404601e-04,7.3827089e-04,1.5993093e-03,3.1475815e-03,5.7136032e-03,9.6870574e-03,1.5501348e-02,2.3617408e-02,3.4509638e-02,4.8655399e-02,6.6528156e-02,8.8593388e-02,1.1530590e-01,1.4710698e-01,1.8442002e-01,2.2764363e-01,2.7714180e-01,3.3323224e-01,3.9617614e-01,4.6617742e-01,5.4340837e-01,6.2809516e-01,7.2073057e-01,8.2254802e-01,9.3653596e-01,1.0000000e+00},
    { 2.0011996e-09,3.0334599e-08,2.9744719e-07,2.0361929e-06,1.0360606e-05,4.1255402e-05,1.3411985e-04,3.6858199e-04,8.8110286e-04,1.8757944e-03,3.6258767e-03,6.4658743e-03,1.0777714e-02,1.6975032e-02,2.5489334e-02,3.6760042e-02,5.1228847e-02,6.9337557e-02,9.1527984e-02,1.1824218e-01,1.4992137e-01,1.8700211e-01,2.2990850e-01,2.7903992e-01,3.3475486e-01,3.9735378e-01,4.6706888e-01,5.4407843e-01,6.2858306e-01,7.2102166e-01,8.2258892e-01,9.3640474e-01,1.0000000e+00},
    { 2.0016439e-09,3.3307703e-08,3.4552168e-07,2.4373333e-06,1.2547021e-05,4.9921575e-05,1.6085196e-04,4.3594462e-04,1.0249446e-03,2.1435420e-03,4.0700331e-03,7.1338963e-03,1.1700785e-02,1.8158450e-02,2.6906523e-02,3.8351151e-02,5.2903925e-02,7.0983681e-02,9.3019452e-02,1.1945280e-01,1.5073790e-01,1.8733796e-01,2.2971655e-01,2.7832306e-01,3.3357221e-01,3.9582001e-01,4.6534334e-01,5.4234129e-01,6.2699883e-01,7.1970133e-01,8.2159174e-01,9.3590212e-01,1.0000000e+00},
    { 2.0009045e-09,3.6393652e-08,3.9754573e-07,2.8771384e-06,1.4929155e-05,5.9179918e-05,1.8859774e-04,5.0342827e-04,1.1633433e-03,2.3899086e-03,4.4591257e-03,7.6879083e-03,1.2419713e-02,1.9013399e-02,2.7837202e-02,3.9267755e-02,5.3692906e-02,7.1516588e-02,9.3164000e-02,1.1908545e-01,1.4975738e-01,1.8567897e-01,2.2736303e-01,2.7531959e-01,3.3003173e-01,3.9192479e-01,4.6133546e-01,5.3849868e-01,6.2359540e-01,7.1696061e-01,8.1967573e-01,9.3506855e-01,1.0000000e+00},
    { 2.0026064e-09,3.9624482e-08,4.5355292e-07,3.3528988e-06,1.7473127e-05,6.8819657e-05,2.1651297e-04,5.6859338e-04,1.2908562e-03,2.6051158e-03,4.7786995e-03,8.1103897e-03,1.2918069e-02,1.9531232e-02,2.8289106e-02,3.9543459e-02,5.3664454e-02,7.1047759e-02,9.2121347e-02,1.1735053e-01,1.4723986e-01,1.8233035e-01,2.2319028e-01,2.7039778e-01,3.2451358e-01,3.8604413e-01,4.5540012e-01,5.3286764e-01,6.1863698e-01,7.1299875e-01,8.1696583e-01,9.3394703e-01,1.0000000e+00},
    { 2.0042618e-09,4.2943528e-08,5.1269727e-07,3.8557834e-06,2.0115777e-05,7.8535280e-05,2.4355220e-04,6.2876678e-04,1.4021495e-03,2.7806461e-03,5.0178941e-03,8.3910082e-03,1.3191132e-02,1.9719757e-02,2.8290524e-02,3.9235043e-02,5.2910939e-02,6.9710562e-02,9.0069003e-02,1.1447022e-01,1.4344999e-01,1.7759414e-01,2.1752999e-01,2.6390865e-01,3.1737564e-01,3.7852867e-01,4.4786580e-01,5.2573989e-01,6.1236551e-01,7.0799752e-01,8.1357590e-01,9.3257693e-01,1.0000000e+00},
    { 2.0040347e-09,4.6292091e-08,5.7396138e-07,4.3750085e-06,2.2784104e-05,8.8000185e-05,2.6869161e-04,6.8157660e-04,1.4930269e-03,2.9108503e-03,5.1714945e-03,8.5287202e-03,1.3247457e-02,1.9603661e-02,2.7889119e-02,3.8419458e-02,5.1543724e-02,6.7654207e-02,8.7195482e-02,1.1067166e-01,1.3865070e-01,1.7176406e-01,2.1069956e-01,2.5618416e-01,3.0895353e-01,3.6970529e-01,4.3903744e-01,5.1738544e-01,6.0500446e-01,7.0212466e-01,8.0961117e-01,9.3099486e-01,1.0000000e+00},
    { 2.0005757e-09,4.9610274e-08,6.3618809e-07,4.8983198e-06,2.5399617e-05,9.6889705e-05,2.9100559e-04,7.2512024e-04,1.5606631e-03,2.9930635e-03,5.2395450e-03,8.5303344e-03,1.3105803e-02,1.9219336e-02,2.7144383e-02,3.7183972e-02,4.9681287e-02,6.5030336e-02,8.3685948e-02,1.0617229e-01,1.3308880e-01,1.6511185e-01,2.0298953e-01,2.4752598e-01,2.9955076e-01,3.5986879e-01,4.2918967e-01,5.0804727e-01,5.9675479e-01,6.9553092e-01,8.0516633e-01,9.2923402e-01,1.0000000e+00},
    { 2.0054041e-09,5.3089720e-08,7.0066160e-07,5.4277442e-06,2.7943670e-05,1.0508154e-04,3.1014538e-04,7.5888391e-04,1.6050622e-03,3.0295572e-03,5.2295910e-03,8.4127536e-03,1.2797122e-02,1.8616494e-02,2.6129000e-02,3.5627555e-02,4.7451088e-02,6.1995900e-02,7.9726632e-02,1.0118621e-01,1.2700372e-01,1.5789844e-01,1.9467726e-01,2.3822136e-01,2.8945649e-01,3.4930078e-01,4.1858599e-01,4.9795972e-01,5.8781138e-01,6.8836332e-01,8.0033445e-01,9.2732752e-01,1.0000000e+00},
    { 2.0048683e-09,5.6437415e-08,7.6380035e-07,5.9362386e-06,3.0284325e-05,1.1214304e-04,3.2512176e-04,7.8128458e-04,1.6246608e-03,3.0203901e-03,5.1459394e-03,8.1878959e-03,1.2344569e-02,1.7832939e-02,2.4898241e-02,3.3824958e-02,4.4948489e-02,5.8667136e-02,7.5454113e-02,9.5869064e-02,1.2056813e-01,1.5031079e-01,1.8596045e-01,2.2847421e-01,2.7887526e-01,3.3819974e-01,4.0741127e-01,4.8728618e-01,5.7830883e-01,6.8072220e-01,7.9517813e-01,9.2529725e-01,1.0000000e+00} };


public:

  MultiPhotAnn(string t1) : 
    Interaction(t1, "")
  {
    name = "multi-phot-ann";
    interaction_order = 1; // set as single prtcl interaction
  }

  double B_QED = 1.0; // critical QED field strength in code units

  // internal storage for the dimensionless photon quantum parameter
  // updated in comp_chi()
  float chi_x = 0.0; 

  // NOTE no override since input arguments are different
  pair_float get_minmax_ene( string t1, string t2, double ene) override final;

  // calculate quantum parameter
  float comp_chi( 
      float ux1, float uy1, float uz1,
      float ex,  float ey,  float ez,
      float bx,  float by,  float bz);

  // calculate optical depth for the process 
  float comp_optical_depth( string t1, 
      float ux1, float uy1, float uz1,
      float ex,  float ey,  float ez,
      float bx,  float by,  float bz
      ) override final;

  void interact(
        string& t1, float& ux1, float& uy1, float& uz1,
        string& t2, float& ux2, float& uy2, float& uz2) override final;

  //pair_float accumulate(string t1, float e1 ) override;

}; // end of MultiPhotAnn class

} // end of namespace qed

