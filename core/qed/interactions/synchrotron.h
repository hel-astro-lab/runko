#pragma once

#include "core/qed/interactions/interaction.h"


namespace qed {
  using std::string;
  using std::tuple;


class Synchrotron :
  public Interaction
{

private:

  float CHIE[32] = { 1.0000000e-04, 1.6580890e-04, 2.7492592e-04, 4.5585165e-04, 7.5584261e-04, 1.2532543e-03, 2.0780073e-03, 3.4455210e-03, 5.7129805e-03, 9.4726303e-03, 1.5706464e-02, 2.6042716e-02, 4.3181141e-02, 7.1598176e-02, 1.1871615e-01, 1.9684194e-01, 3.2638147e-01, 5.4116953e-01, 8.9730725e-01, 1.4878153e+00, 2.4669302e+00, 4.0903899e+00, 6.7822306e+00, 1.1245542e+01, 1.8646110e+01, 3.0916910e+01, 5.1262989e+01, 8.4998598e+01, 1.4093524e+02, 2.3368318e+02, 3.8746751e+02, 6.4245563e+02};

  float XI[32][33] = {
  { 1.0003233e-03,1.3711393e-03,1.8794153e-03,2.5761072e-03,3.5310600e-03,4.8400099e-03,6.6341815e-03,9.0934406e-03,1.2464315e-02,1.7084659e-02,2.3417309e-02,3.2095778e-02,4.3986128e-02,6.0271435e-02,8.2563358e-02,1.1304164e-01,1.5461937e-01,2.1109814e-01,2.8719640e-01,3.8811916e-01,5.1779768e-01,6.7379432e-01,8.3605306e-01,9.5650023e-01,9.9743943e-01,9.9999653e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00,1.0000003e+00,1.0000004e+00,1.0000005e+00,1.0000006e+00},
  { 1.0006853e-03,1.3643884e-03,1.8602810e-03,2.5364077e-03,3.4582755e-03,4.7151996e-03,6.4289572e-03,8.7655831e-03,1.1951447e-02,1.6295147e-02,2.2217245e-02,3.0290455e-02,4.1293768e-02,5.6285904e-02,7.6703036e-02,1.0448133e-01,1.4220492e-01,1.9325702e-01,2.6189564e-01,3.5302947e-01,4.7110036e-01,6.1665154e-01,7.7801461e-01,9.1881749e-01,9.8944972e-01,9.9988807e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00,1.0000003e+00,1.0000004e+00,1.0000005e+00,1.0000006e+00},
  { 1.0003192e-03,1.3567159e-03,1.8400908e-03,2.4956839e-03,3.3848537e-03,4.5908194e-03,6.2264495e-03,8.4448236e-03,1.1453553e-02,1.5534178e-02,2.1068401e-02,2.8573372e-02,3.8748978e-02,5.2541578e-02,7.1229230e-02,9.6529102e-02,1.3072858e-01,1.7682757e-01,2.3863954e-01,3.2070099e-01,4.2758922e-01,5.6166826e-01,7.1725109e-01,8.6952614e-01,9.7064984e-01,9.9876094e-01,9.9999914e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00,1.0000003e+00,1.0000004e+00,1.0000005e+00},
  { 1.0000193e-03,1.3491757e-03,1.8202400e-03,2.4557762e-03,3.3132096e-03,4.4700154e-03,6.0307190e-03,8.1363392e-03,1.0977125e-02,1.4809721e-02,1.9980265e-02,2.6955337e-02,3.6363213e-02,4.9049089e-02,6.6149065e-02,8.9184112e-02,1.2017525e-01,1.6177430e-01,2.1737556e-01,2.9110861e-01,3.8744495e-01,5.0975496e-01,6.5635397e-01,8.1193422e-01,9.3791660e-01,9.9335632e-01,9.9995121e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00,1.0000003e+00,1.0000004e+00,1.0000005e+00},
  { 1.0005965e-03,1.3428220e-03,1.8020960e-03,2.4184516e-03,3.2456141e-03,4.3556838e-03,5.8454207e-03,7.8446775e-03,1.0527714e-02,1.4128369e-02,1.8960370e-02,2.5444435e-02,3.4144224e-02,4.5814140e-02,6.1463261e-02,8.2437342e-02,1.1051938e-01,1.4804746e-01,1.9802760e-01,2.6417579e-01,3.5071213e-01,4.6146386e-01,5.9726227e-01,7.4980325e-01,8.9166093e-01,9.7821874e-01,9.9924563e-01,9.9999962e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00,1.0000003e+00,1.0000004e+00},
  { 1.0005864e-03,1.3357460e-03,1.7831717e-03,2.3804685e-03,3.1778377e-03,4.2422961e-03,5.6633085e-03,7.5603059e-03,1.0092720e-02,1.3473371e-02,1.7986296e-02,2.4010441e-02,3.2050949e-02,4.2780485e-02,5.7094281e-02,7.6181424e-02,1.0161238e-01,1.3544360e-01,1.8032592e-01,2.3957351e-01,3.1707729e-01,4.1677001e-01,5.4095794e-01,6.8613522e-01,8.3479285e-01,9.4879398e-01,9.9504410e-01,9.9996862e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00,1.0000003e+00,1.0000004e+00},
  { 1.0001057e-03,1.3281143e-03,1.7637011e-03,2.3421491e-03,3.1103129e-03,4.1304142e-03,5.4850818e-03,7.2840437e-03,9.6730123e-03,1.2845477e-02,1.7058338e-02,2.2652572e-02,3.0080430e-02,3.9941132e-02,5.3028110e-02,7.0390710e-02,9.3410205e-02,1.2389158e-01,1.6416416e-01,2.1716295e-01,2.8641528e-01,3.7574134e-01,4.8821505e-01,6.2341142e-01,7.7140616e-01,9.0427346e-01,9.8161104e-01,9.9939429e-01,9.9999971e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00,1.0000003e+00},
  { 1.0001123e-03,1.3211695e-03,1.7452930e-03,2.3055692e-03,3.0457059e-03,4.0234421e-03,5.3150521e-03,7.0212952e-03,9.2752741e-03,1.2252810e-02,1.6186130e-02,2.1381877e-02,2.8244715e-02,3.7308133e-02,4.9274936e-02,6.5070337e-02,8.5907916e-02,1.1336940e-01,1.4949582e-01,1.9687198e-01,2.5865562e-01,3.3842743e-01,4.3956556e-01,5.6348737e-01,7.0553474e-01,8.4756280e-01,9.5354065e-01,9.9552259e-01,9.9997093e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00,1.0000003e+00},
  { 1.0001440e-03,1.3143258e-03,1.7272037e-03,2.2697817e-03,2.9828032e-03,3.9198109e-03,5.1511668e-03,6.7693357e-03,8.8958272e-03,1.1690314e-02,1.5362599e-02,2.0188295e-02,2.6529281e-02,3.4860282e-02,4.5803520e-02,6.0174186e-02,7.9037560e-02,1.0377799e-01,1.3617995e-01,1.7851007e-01,2.3356912e-01,3.0463433e-01,3.9510082e-01,5.0738967e-01,6.4024658e-01,7.8320396e-01,9.0945128e-01,9.8235064e-01,9.9938871e-01,9.9999972e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00},
  { 1.0006838e-03,1.3082133e-03,1.7102526e-03,2.2358464e-03,2.9229653e-03,3.8212491e-03,4.9955928e-03,6.5308342e-03,8.5378822e-03,1.1161724e-02,1.4591885e-02,1.9076059e-02,2.4937836e-02,3.2599611e-02,4.2612257e-02,5.5693903e-02,7.2779247e-02,9.5079095e-02,1.2415137e-01,1.6197765e-01,2.1102530e-01,2.7424474e-01,3.5487937e-01,4.5580842e-01,5.7782980e-01,7.1584722e-01,8.5235795e-01,9.5410187e-01,9.9534592e-01,9.9996926e-01,1.0000000e+00,1.0000001e+00,1.0000002e+00},
  { 1.0001691e-03,1.3008828e-03,1.6920098e-03,2.2007341e-03,2.8624128e-03,3.7230337e-03,4.8424111e-03,6.2983429e-03,8.1920170e-03,1.0655040e-02,1.3858573e-02,1.8025186e-02,2.3444199e-02,3.0491446e-02,3.9654697e-02,5.1566663e-02,6.7047395e-02,8.7155742e-02,1.1325095e-01,1.4706220e-01,1.9075339e-01,2.4695146e-01,3.1866057e-01,4.0888312e-01,5.1955906e-01,6.4906834e-01,7.8730360e-01,9.0948934e-01,9.8160825e-01,9.9934787e-01,9.9999984e-01,1.0000000e+00,1.0000001e+00},
  { 1.0004553e-03,1.2947227e-03,1.6755441e-03,2.1683777e-03,2.8061703e-03,3.6315590e-03,4.6997220e-03,6.0820671e-03,7.8710045e-03,1.0186122e-02,1.3182171e-02,1.7059384e-02,2.2076764e-02,2.8569150e-02,3.6969043e-02,4.7834716e-02,6.1886496e-02,8.0051340e-02,1.0351600e-01,1.3378898e-01,1.7276355e-01,2.2276194e-01,2.8651174e-01,3.6694094e-01,4.6654127e-01,5.8578544e-01,7.1972568e-01,8.5225669e-01,9.5272121e-01,9.9513786e-01,9.9997896e-01,1.0000000e+00,1.0000001e+00},
  { 1.0007352e-03,1.2887699e-03,1.6597076e-03,2.1374097e-03,2.7526056e-03,3.5448690e-03,4.5651641e-03,5.8791232e-03,7.5712687e-03,9.7504482e-03,1.2556830e-02,1.6170898e-02,2.0824999e-02,2.6818104e-02,3.4534609e-02,4.4468362e-02,5.7253630e-02,7.3703756e-02,9.4857153e-02,1.2203177e-01,1.5688408e-01,2.0145995e-01,2.5820686e-01,3.2987573e-01,4.1915216e-01,5.2767850e-01,6.5381985e-01,7.8830259e-01,9.0845548e-01,9.8140452e-01,9.9950731e-01,1.0000000e+00,1.0000001e+00},
  { 1.0005879e-03,1.2825747e-03,1.6440315e-03,2.1073544e-03,2.7012516e-03,3.4625215e-03,4.4383333e-03,5.6891493e-03,7.2924708e-03,9.3476388e-03,1.1981985e-02,1.5358707e-02,1.9686934e-02,2.5234558e-02,3.2344508e-02,4.1455410e-02,5.3128056e-02,6.8078910e-02,8.7220235e-02,1.1170765e-01,1.4299410e-01,1.8288214e-01,2.3355569e-01,2.9754579e-01,3.7752831e-01,4.7573331e-01,5.9251857e-01,7.2333374e-01,8.5345013e-01,9.5375427e-01,9.9617180e-01,9.9999892e-01,1.0000000e+00},
  { 1.0005855e-03,1.2769325e-03,1.6296025e-03,2.0796746e-03,2.6540501e-03,3.3870596e-03,4.3225155e-03,5.5163302e-03,7.0398583e-03,8.9841598e-03,1.1465440e-02,1.4631987e-02,1.8673000e-02,2.3829812e-02,3.0410083e-02,3.8805713e-02,4.9515611e-02,6.3174714e-02,8.0589345e-02,1.0277885e-01,1.3102421e-01,1.6691906e-01,2.1241094e-01,2.6980437e-01,3.4166020e-01,4.3044777e-01,5.3764825e-01,6.6172499e-01,7.9409111e-01,9.1320365e-01,9.8519209e-01,9.9993481e-01,1.0000000e+00},
  { 1.0004657e-03,1.2715944e-03,1.6161996e-03,2.0541938e-03,2.6108854e-03,3.3184419e-03,4.2177479e-03,5.3607679e-03,6.8135486e-03,8.6600347e-03,1.1006917e-02,1.3989793e-02,1.7780976e-02,2.2599398e-02,2.8723095e-02,3.6504917e-02,4.6392316e-02,5.8952558e-02,7.4904057e-02,9.5153337e-02,1.2083852e-01,1.5337759e-01,1.9451366e-01,2.4633896e-01,3.1125533e-01,3.9177674e-01,4.8997036e-01,6.0611866e-01,7.3584187e-01,8.6482850e-01,9.6326245e-01,9.9910238e-01,1.0000000e+00},
  { 1.0003506e-03,1.2667725e-03,1.6041502e-03,2.0313813e-03,2.5723961e-03,3.2574987e-03,4.1250636e-03,5.2236857e-03,6.6149019e-03,8.3766375e-03,1.0607570e-02,1.3432650e-02,1.7010092e-02,2.1540189e-02,2.7276431e-02,3.4539438e-02,4.3734424e-02,5.5373260e-02,7.0102315e-02,8.8735851e-02,1.1229503e-01,1.4205288e-01,1.7958036e-01,2.2678167e-01,2.8589093e-01,3.5936696e-01,4.4954664e-01,5.5776105e-01,6.8232461e-01,8.1443510e-01,9.3156680e-01,9.9508222e-01,1.0000000e+00},
  { 1.0005394e-03,1.2628692e-03,1.5939788e-03,2.0119015e-03,2.5393988e-03,3.2051997e-03,4.0455658e-03,5.1062660e-03,6.4450694e-03,8.1348905e-03,1.0267761e-02,1.2959836e-02,1.6357718e-02,2.0646408e-02,2.6059318e-02,3.2890798e-02,4.1511786e-02,5.2389404e-02,6.6111733e-02,8.3418329e-02,1.0523583e-01,1.3271941e-01,1.6729807e-01,2.1071555e-01,2.6504817e-01,3.3265584e-01,4.1596826e-01,5.1689290e-01,6.3540136e-01,7.6647404e-01,8.9439092e-01,9.8490686e-01,1.0000000e+00},
  { 1.0006903e-03,1.2594760e-03,1.5851855e-03,1.9951257e-03,2.5110795e-03,3.1604627e-03,3.9777809e-03,5.0064634e-03,6.3011704e-03,7.9306973e-03,9.9816298e-03,1.2562943e-02,1.5811786e-02,1.9900755e-02,2.5047020e-02,3.1523742e-02,3.9674313e-02,4.9930082e-02,6.2832596e-02,7.9061485e-02,9.9467731e-02,1.2511200e-01,1.5730822e-01,1.9766698e-01,2.4812549e-01,3.1093290e-01,3.8851962e-01,4.8309198e-01,5.9561578e-01,7.2353937e-01,8.5632016e-01,9.6795534e-01,1.0000000e+00},
  { 1.0006417e-03,1.2563858e-03,1.5774931e-03,1.9806691e-03,2.4868888e-03,3.1224882e-03,3.9205342e-03,4.9225449e-03,6.1806495e-03,7.7603003e-03,9.7436774e-03,1.2233963e-02,1.5360706e-02,1.9286553e-02,2.4215681e-02,3.0404345e-02,3.8174020e-02,4.7927718e-02,6.0170295e-02,7.5533933e-02,9.4809475e-02,1.1898270e-01,1.4927567e-01,1.8719085e-01,2.3454790e-01,2.9348997e-01,3.6640524e-01,4.5564152e-01,5.6275091e-01,6.8675449e-01,8.2071196e-01,9.4638959e-01,1.0000000e+00},
  { 1.0004974e-03,1.2536966e-03,1.5709737e-03,1.9685451e-03,2.4667313e-03,3.0909951e-03,3.8732434e-03,4.8534577e-03,6.0817381e-03,7.6208631e-03,9.5494988e-03,1.1966219e-02,1.4994539e-02,1.8789228e-02,2.3544198e-02,2.9502368e-02,3.6967962e-02,4.6321759e-02,5.8039992e-02,7.2717859e-02,9.1098872e-02,1.1410991e-01,1.4290075e-01,1.7888766e-01,2.2379393e-01,2.7966905e-01,3.4884348e-01,4.3372068e-01,5.3619389e-01,6.5627827e-01,7.8944373e-01,9.2335711e-01,1.0000000e+00},
  { 1.0007229e-03,1.2519275e-03,1.5661904e-03,1.9593405e-03,2.4511804e-03,3.0664835e-03,3.8362419e-03,4.7992276e-03,6.0039449e-03,7.5110740e-03,9.3965269e-03,1.1755271e-02,1.4706110e-02,1.8397666e-02,2.3015855e-02,2.8793220e-02,3.6020570e-02,4.5061426e-02,5.6369896e-02,7.0512755e-02,8.8196904e-02,1.1030312e-01,1.3792493e-01,1.7241095e-01,2.1540729e-01,2.6888464e-01,3.3511428e-01,4.1651089e-01,5.1516347e-01,6.3171554e-01,7.6322769e-01,9.0144466e-01,1.0000000e+00},
  { 1.0007263e-03,1.2503050e-03,1.5621280e-03,1.9517189e-03,2.4384728e-03,3.0466220e-03,3.8064420e-03,4.7557594e-03,5.9418341e-03,7.4237128e-03,9.2751680e-03,1.1588371e-02,1.4478477e-02,1.8089362e-02,2.2600770e-02,2.8237251e-02,3.5279286e-02,4.4077123e-02,5.5067899e-02,6.8796739e-02,8.5942762e-02,1.0735123e-01,1.3407199e-01,1.6740154e-01,2.0892559e-01,2.6055106e-01,3.2449601e-01,4.0316607e-01,4.9876191e-01,6.1232764e-01,7.4197417e-01,8.8215268e-01,1.0000000e+00},
  { 1.0005245e-03,1.2487893e-03,1.5586571e-03,1.9454140e-03,2.4281386e-03,3.0306439e-03,3.7826516e-03,4.7212585e-03,5.8927662e-03,7.3549655e-03,9.1799867e-03,1.1457858e-02,1.4300946e-02,1.7849497e-02,2.2278551e-02,2.7806565e-02,3.4706156e-02,4.3317468e-02,5.4064730e-02,6.7476677e-02,8.4211596e-02,1.0508804e-01,1.3112222e-01,1.6357059e-01,2.0397255e-01,2.5418486e-01,3.1638085e-01,3.9294946e-01,4.8615471e-01,5.9729890e-01,7.2519150e-01,8.6605847e-01,1.0000000e+00},
  { 1.0001344e-03,1.2473409e-03,1.5556503e-03,1.9401655e-03,2.4197225e-03,3.0178133e-03,3.7637361e-03,4.6940310e-03,5.8542700e-03,7.3012889e-03,9.1059720e-03,1.1356724e-02,1.4163800e-02,1.7664705e-02,2.2030929e-02,2.7476335e-02,3.4267618e-02,4.2737308e-02,5.3299908e-02,6.6471825e-02,8.2895809e-02,1.0337071e-01,1.2888755e-01,1.6067192e-01,2.0022806e-01,2.4937433e-01,3.1024819e-01,3.8522070e-01,4.7659180e-01,5.8583250e-01,7.1222171e-01,8.5315230e-01,1.0000000e+00},
  { 1.0003845e-03,1.2469019e-03,1.5541669e-03,1.9371490e-03,2.4145065e-03,3.0094957e-03,3.7511039e-03,4.6754611e-03,5.8276009e-03,7.2636541e-03,9.0535831e-03,1.1284591e-02,1.4065368e-02,1.7531387e-02,2.1851503e-02,2.7236168e-02,3.3947672e-02,4.2312876e-02,5.2739026e-02,6.5733309e-02,8.1926887e-02,1.0210410e-01,1.2723756e-01,1.5852949e-01,1.9745680e-01,2.4580864e-01,3.0569420e-01,3.7946769e-01,4.6944841e-01,5.7721808e-01,7.0237370e-01,8.4308382e-01,1.0000000e+00},
  { 9.9997606e-04,1.2458528e-03,1.5521863e-03,1.9338419e-03,2.4093400e-03,3.0017549e-03,3.7398342e-03,4.6593943e-03,5.8050583e-03,7.2324210e-03,9.0107472e-03,1.1226332e-02,1.3986690e-02,1.7425767e-02,2.1710445e-02,2.7048629e-02,3.3699323e-02,4.1985167e-02,5.2308004e-02,6.5168155e-02,8.1188153e-02,1.0114164e-01,1.2598794e-01,1.5691247e-01,1.9537128e-01,2.4313112e-01,3.0228016e-01,3.7515901e-01,4.6409824e-01,5.7075432e-01,6.9494300e-01,8.3535374e-01,1.0000000e+00},
  { 1.0002858e-03,1.2458186e-03,1.5516206e-03,1.9324855e-03,2.4068386e-03,2.9976277e-03,3.7334334e-03,4.6498519e-03,5.7912169e-03,7.2127444e-03,8.9832036e-03,1.1188244e-02,1.3934538e-02,1.7354941e-02,2.1614917e-02,2.6920537e-02,3.3528438e-02,4.1758206e-02,5.2007764e-02,6.4772433e-02,8.0668433e-02,1.0046156e-01,1.2510157e-01,1.5576204e-01,1.9388405e-01,2.4121671e-01,2.9983192e-01,3.7205971e-01,4.6023673e-01,5.6606957e-01,6.8952477e-01,8.2964664e-01,1.0000000e+00},
  { 1.0003898e-03,1.2456481e-03,1.5510347e-03,1.9312908e-03,2.4047715e-03,2.9943320e-03,3.7284309e-03,4.6425035e-03,5.7806727e-03,7.1978785e-03,8.9625303e-03,1.1159808e-02,1.3895776e-02,1.7302498e-02,2.1544413e-02,2.6826268e-02,3.3402989e-02,4.1591959e-02,5.1788270e-02,6.4483629e-02,8.0289680e-02,9.9966523e-02,1.2445698e-01,1.5492635e-01,1.9280561e-01,2.3983122e-01,2.9806197e-01,3.6982010e-01,4.5744661e-01,5.6268297e-01,6.8560100e-01,8.2548889e-01,1.0000000e+00},
  { 1.0008392e-03,1.2459677e-03,1.5511338e-03,1.9310422e-03,2.4039987e-03,2.9927933e-03,3.7257971e-03,4.6383304e-03,5.7743641e-03,7.1886383e-03,8.9493006e-03,1.1141189e-02,1.3869920e-02,1.7266976e-02,2.1496042e-02,2.6760883e-02,3.3315157e-02,4.1474608e-02,5.1632219e-02,6.4276986e-02,8.0017106e-02,9.9608350e-02,1.2398823e-01,1.5431576e-01,1.9201459e-01,2.3881226e-01,2.9675685e-01,3.6816241e-01,4.5537195e-01,5.6015045e-01,6.8264303e-01,8.2230770e-01,1.0000000e+00},
  { 1.0010717e-03,1.2460771e-03,1.5510459e-03,1.9306537e-03,2.4031679e-03,2.9913268e-03,3.7234335e-03,4.6347182e-03,5.7690336e-03,7.1809648e-03,8.9384561e-03,1.1126081e-02,1.3849110e-02,1.7238579e-02,2.1457589e-02,2.6709154e-02,3.3245955e-02,4.1382481e-02,5.1510093e-02,6.4115711e-02,7.9804876e-02,9.9330011e-02,1.2362448e-01,1.5384237e-01,1.9140170e-01,2.3802370e-01,2.9574890e-01,3.6688345e-01,4.5376955e-01,5.5818867e-01,6.8033766e-01,8.1979345e-01,1.0000000e+00},
  { 1.0009047e-03,1.2457492e-03,1.5504884e-03,1.9297739e-03,2.4018415e-03,2.9893878e-03,3.7206615e-03,4.6308217e-03,5.7636283e-03,7.1735456e-03,8.9283612e-03,1.1112445e-02,1.3830805e-02,1.7214136e-02,2.1425099e-02,2.6666144e-02,3.3189222e-02,4.1307886e-02,5.1412293e-02,6.3987824e-02,7.9638059e-02,9.9112940e-02,1.2334275e-01,1.5347787e-01,1.9093211e-01,2.3742231e-01,2.9498444e-01,3.6591956e-01,4.5256724e-01,5.5672011e-01,6.7861273e-01,8.1790556e-01,1.0000000e+00}
  };


public:

  Synchrotron(string t1) : 
    Interaction(t1, "")
  {
    name = "synchrotron";
    interaction_order = 1; // set as single prtcl interaction
  }

  double B_QED = 1.0; // critical QED field strength in code units
  double C_SYNC = 1.0; // A constant for synchrotron cooling calculation

  // internal storage for the dimensionless electorn quantum parameter
  // updated in comp_chi()
  float chi_e = 0.0; 

  // NOTE no override since input arguments are different
  pair_float get_minmax_ene( string t1, string t2, double ene) override final;

  // calculate quantum parameter
  float comp_chi( 
      float ux1, float uy1, float uz1,
      float ex,  float ey,  float ez,
      float bx,  float by,  float bz);

  // calculate optical depth for synchrotron photon emission
  float comp_optical_depth( string t1, 
      float ux1, float uy1, float uz1,
      float ex,  float ey,  float ez,
      float bx,  float by,  float bz
      ) override final;

  pair_float accumulate(string t3, float e3, string t4, float e4) override;

  void interact(
        string& t1, float& ux1, float& uy1, float& uz1,
        string& t2, float& ux2, float& uy2, float& uz2) override final;


}; // end of Synchrotron class


} // end of namespace qed

